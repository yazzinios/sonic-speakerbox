services:

  sonicbeat:
    build:
      context: https://github.com/yazzinios/sonic-speakerbox.git
      no_cache: true
      args:
        VITE_SUPABASE_PROJECT_ID: "iaedzkkysscmzsqccftn"
        VITE_SUPABASE_PUBLISHABLE_KEY: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlhZWR6a2t5c3NjbXpzcWNjZnRuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwMTkzNjEsImV4cCI6MjA4NzU5NTM2MX0.-sxVzHBLlSvofDvN73_0KkfT5Hc8waoeEKP7AdlYWps"
        VITE_SUPABASE_URL: "https://iaedzkkysscmzsqccftn.supabase.co"
    container_name: sonicbeat
    ports:
      - "8083:80"
    restart: always
    networks:
      sonicbeat-net:
        ipv4_address: 10.10.0.2
    depends_on:
      - radio-server

  radio-server:
    build:
      context: https://github.com/yazzinios/sonic-speakerbox.git#main:streaming-server
      no_cache: true
    container_name: radio-server
    ports:
      - "8000:8000"   # Icecast â€” listeners connect here directly
                      # URL: http://YOUR_SERVER_IP:8000/deck-a
    environment:
      # All services run inside this single container
      ICECAST_HOST: "localhost"
      ICECAST_PORT: "8000"
      ICECAST_SOURCE_PASSWORD: "sonicbeat_source_2024"
      ICECAST_ADMIN_PASSWORD: "sonicbeat_admin_2024"
      UPLOAD_DIR: "/data/uploads"
      LIQ_HOST: "localhost"
      LIQ_TELNET_PORT: "1234"
      LIQ_HARBOR_PORT: "8005"
    volumes:
      - sonicbeat-uploads:/data
    restart: always
    networks:
      sonicbeat-net:
        ipv4_address: 10.10.0.3

networks:
  sonicbeat-net:
    name: sonicbeat-net
    driver: bridge
    ipam:
      config:
        - subnet: 10.10.0.0/24
          gateway: 10.10.0.1

volumes:
  sonicbeat-uploads:
    name: sonicbeat-uploads
